#include "04_variables.lc"
#include <std/assert>

// 'i' is defined in the included file "04_variables.lc"
assert_eq!(i, 100)

#define PI 3.14
#define HELLO "world"

#alias add sum
// // macros dont support aliasing or defined values
// sum_output: float = add(2, 3)
// assert_eq!(sum_output, 5.0)
// they do now
assert_eq!(add(2, 3), 5.0)
#unalias add

// aliasing 1 to 2
#alias 1 2
assert_eq!(1, 2)
#unalias 1

#ifdef PI
    pi: float = PI
    assert_eq!(pi, 3.14)
#endif

#ifndef UNDEFINED
    hello: str = HELLO
    assert_eq!(hello, "world")
#endif

assert_eq!(sum(2, 3), 5.0)

// precompile

i: int = #precompile: 1 + 2 #endprecompile
assert_eq!(i, 3)

#macro #no-group precompile!($expr):
    #precompile: $expr #endprecompile
#endmacro

for (i in precompile!([0...100])):
    print(i)  // precompile is evaluated at preprocessor time
end

// link preprocessor
// automatically generates FFI bindings and wrappers for C libraries, only supports some primitive types for now (int, float, str, bool, void)
// #link "header.h" "library.so"
// you need to have header.h and library.so
// i dont have it
// thats why its commented out

try:
    (/* pushes a token to the token stream. having this is a () because syntax hl is fucked */)
    #push ( ("IDENTIFIER", "42") )
    throw "This should not be reached" from "FuckThis"
catch (et, em):
    assert_eq!(em, "Variable '42' is not defined.")
end

mutable a: int = 10

#push ( [ ("IDENTIFIER", "a"), ("OPERATOR", "="), ("NUMBER", "69") ] )

assert_eq!(a, 69)

#ifdef UNDEFINED
    #error "This should not be triggered"
#endif
