import (LasmFunction, compile, call, free) from lasm

f: &LasmFunction = compile('
load msg, r1           ; load value of msg into r1
mov r1, r0
syscall strlen

mov r0, r2
mov 1, r0
syscall write

mov 69, r0
syscall exit
')

msg: str = "Hello, World!"

print("------------------------------")
(exit_code, _) := call(f, { "msg": msg+"\n" })
print("------------------------------")
print(f"Program exited with code {exit_code}")
free(f) // optional
